<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- icons -->
	<link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
    <link href="https://cdn.lineicons.com/4.0/lineicons.css" rel="stylesheet" />

	<!-- My CSS -->
    <link rel="stylesheet" href="assets/css/new.css">
	<link rel="stylesheet" href="assets/css/manager.css">
	<link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/export_request.css">
	<link rel="stylesheet" href="assets/css/swiper-bundle.min.css">

	<title>Export</title>
	<!-- JS -->
	
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
	<script src="https://code.jquery.com/jquery-3.6.3.js"></script>
</head>
<body>
    <header class="header" id="header">
        <nav class="nav container">
            <a href="dashboard.html" class="nav__logo">
                <i class='bx bxl-medium-old'></i>MY WAREHOUSE
            </a>

            <div class="nav__btns">
                <!-- Theme change button -->
                <form action="" id="search-bar" class="search">
                    <input type="search" placeholder="Type something..." class="search__input">
                    <a href="#"><i class='bx bx-search'></i></a>
                </form>
                <i class='bx bx-moon change-theme' id="theme-button"></i>
                <!-- <div class="nav__shop" id="cart-shop">
                        <i class='bx bx-shopping-bag' ></i>
                    </div> -->
    
                <div class="nav__toggle" id="nav-toggle">
                    <i class='bx bx-grid-alt'></i>
                </div>
    
                <div class="nav__user" id="info-user">
                    <a href="dashboard.html"><i class='bx bx-user'></i></a>
                    <ul class="dropMenu">
                        <li>
                            <div style="display: flex; justify-content: center; align-items: center;">
                                <img class="avt-dropMenu" src="assets/img/nike.png" alt="">
                                <p>Thanh Nguyễn</p>
                            </div>
                            <p style="font-size: 14px;color: rgb(118, 113, 113);">Quản lí kho</p>
                        </li>
                        <li>
                            <img src="assets/img/edit.png" alt="">
                            <a href="profile.html">Edit Profile</a>
                        </li>
                        <li>
                            <img src="assets/img/logout.png" alt="">
                            <a style="color: rgb(242, 90, 90);" href="login.html">Logout</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>
    <!-- SIDEBAR -->
    <section id="sidebar">
        <!-- <a href="#" class="brand">
    			<i class='bx bxs-smile'></i>
    			<span class="text">AdminHub</span>
    		</a> -->
        <ul class="side-menu top">
            <li class="active">
                <a href="export_request.html" class="active">
                    <img src="assets/img/request.png" alt="">
                    <span class="text">Export request</span>
                </a>
            </li>
            <li>
                <a href="#">
                    <img src="assets/img/personal-information.png" alt="">
                    <span class="text">Profile</span>
                </a>
            </li>
            <li>
                <a href="changePass.html">
                    <img src="assets/img/change_pass.png" alt="">
                    <span class="text">Change Password</span>
                </a>
            </li>
        </ul>
    </section>
	<!-- SIDEBAR -->

	<!-- CONTENT -->
	<section id="content">
		<!-- NAVBAR -->
		<nav>
			
			<a href="#" class="nav-link"><i class='bx bx-menu' ></i></a>
			<a href="#" class="btn-download">
				<i class='bx bxs-cloud-download' ></i>
				<span class="text">Download PDF</span>
			</a>
		</nav>
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main>
            <div id ="main__product">
                <div class="head-title">
                </div>
                <!-- <div class="dialog" id="confirmDialog_">
                    <div class="dialog-content">
                      <h2>Xác nhận xóa</h2>
                      <p>Bạn có chắc chắn muốn xóa thông tin sản phẩm</p><output id = "id_"></output>
                      <div class="dialog-buttons">
                        <button id="confirmBtn">Đồng ý</button>
                        <button id="cancelBtn">Hủy bỏ</button>
                      </div>
                    </div>
                </div>    -->
                <div class="table-data">
                    <div class="order">
                        <!-- <h1 class ="choose_product">Chọn sản phẩm</h1> -->
                        <div class="head">
                            <!-- <h3>Danh sách sản phẩm</h3> -->
                                <form action="" id="search-bar" class="search">
                                <input type="search" placeholder="Type something..." class="search__input">
                                <a href="#"><i class='bx bx-search' ></i></a>
                                </form>
                            <!-- <a href="#" onclick="openDetail_ad()"><i class="lni lni-circle-plus"></i></a> -->
                        </div>
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Image</th>
                                <!-- <th>Inventory Number</th> -->
                                <!-- <th>Category</th> -->
                                <th>Color</th>  
                                <th>Size</th>
                                <th>Price</th>
                                <th>Mfg</th>
                                <th>Quantity</th>
                                <th>Select</th>
                            </tr>
                        </thead>
                        <tbody>
                                <tr class="productRequest">
                                    <td><p class="code">B6S01</p></td>
                                    <td class="name">Nike Air Force 1 '07</td>
                                    <td><img class="img_product" src="assets/img/1.png"></td>
                                    <!-- <td><p>Life Style</p></td> -->
                                    <td>
                                        <p>Back</p>
                                    </td>
                                    <td>
                                        <p>6</p>
                                    </td>
                                    <td><p>150</p></td>
                                    <td><p>2023</p></t>
                                    <td><input class='quantityRe' type="number" min="0" value="1"></td>
                                    <td><input class='select-product' type="checkbox"></td>
                                    <!-- <td><span class="status completed">Completed</span></td> -->
                                </tr>
                                <tr class="productRequest">
                                    <td><p class="code">B6S02</p></td>
                                    <td class="name">Nike Air Force 1 '07</td>
                                    <td><img class="img_product" src="assets/img/1.png"></td>
                                    <!-- <td><p>Life Style</p></td> -->
                                    <td><p>Back</p></td>
                                    <td><p>6</p></td>
                                    <td><p>150</p></td>
                                    <td><p>2023</p></t>
                                    <td><input class='quantityRe' type="number" min="0" value="1"></td>
                                    <td><input class='select-product' type="checkbox"></td>
                                    <!-- <td><span class="status completed">Completed</span></td> -->
                                </tr>
                                
                        </tbody>
                    </table>
                    <div class="create-btn" id="open-dia">
                        <button>Create request</button>
                    </div>
                </div>

            </div>
    
            </div>
        </main>
        <dialog id="dia-request">
            <div style="display: block;" class="request-content">
                <div class="head_request">
                    <div>
                        <h4><i class='bx bxl-medium-old'></i>  MY WAREHOUSE</h4>
                        <h5>Address: ABC, DEF, HG</h5>
                    </div>
                    <div>
                        <h5>SOCIALIST REPUBLIC OF VIETNAM</h5>
                        <h5>Independence - Freedom - Happiness</h5>
                    </div>
                </div>
                <h3 class="title">GOOD DELIVERY NOTE</h3>
                <div class="info_request">
                    <div class = "detail_info">
                        <p>Dear: </p>
                        <input>
                    </div>
                    <div class = "detail_info">
                        <p>From: </p>
                        <input>
                    </div>
                    <div class = "detail_info">
                        <p>Position: </p>
                        <input>
                    </div>
                    <div class = "detail_info">
                        <p>From Department: </p>
                        <input>
                    </div>
                    <div class = "detail_info">
                        <p>Reason: </p>
                        <input>
                    </div>
                </div>
                <div class="info_product">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Quantity</th>
                                <th>Note</th>
                            </tr>
                        </thead>
                        <tbody id="listProductReq">
                        
                        </tbody>
                    </table>
                </div>
                <div class="sign_request">
                   <i><input class="dated" type="text" placeholder="Dated"></i>
                    <br>
                    <div class="sign-area">
                        <div>
                            <span>Stock keeper</span>
                        </div>
                        <div>
                            <span>Sales manager</span>
                        </div>
                    </div>
                </div>
    
            </div>
            <div class="group-btn">
                <button class="submit">Send request</button>
                <button id="close-dia" value="cancel">Close</button>
                
            </div>
        </dialog>
    </section>
    <!--=============== SCROLL UP ===============-->
	 <a href="#" class="scrollup" id="scroll-up"> 
        <i class='bx bx-up-arrow-alt scrollup__icon' ></i>
    </a>

    <!--=============== SWIPER JS ===============-->
    <script src="assets/js/swiper-bundle.min.js"></script>

    <!--=============== MAIN JS ===============-->
    <!-- <script src="assets/js/main.js"></script> -->
	<script src="assets/js/theme.js"></script>
    <script>
        const dialogRequest = document.getElementById('dia-request');
        const openDialog = document.getElementById('open-dia');
        const closeDialog = document.getElementById('close-dia');


        closeDialog.addEventListener("click", () => {
            dialogRequest.close();
        });

        const listProduct = document.getElementsByClassName('select-product');
        let selectedProducts = []; 
        let productHTML = '';

        for (const i of listProduct) {
            const iParent = i.closest('.productRequest');
            const nameElement = iParent.querySelector('.name');
            const codeElement = iParent.querySelector('.code');
            const quantityElement = iParent.querySelector('.quantityRe');
            const code = codeElement.textContent.trim(); 
            const name = nameElement.textContent.trim(); 
            let quantity = quantityElement.value;


            quantityElement.addEventListener('input',() =>{
                if(i.checked) {
                    quantity = quantityElement.value;
                    selectedProducts = selectedProducts.filter((product) => product.code !== code);
                    selectedProducts.push({ code, name, quantity });
                    productHTML = selectedProducts
                        .map((product) => `
                            <tr>
                            <td>
                                <p>${product.code}</p>
                            </td>
                            <td>
                                <p>${product.name}</p>
                            </td>
                            <td>
                                <p>${product.quantity}</p>
                            </td>
                            <td>
                                <input type="text">
                            </td>
                            </tr>
                        `)
                        .join('');
                }
                else {
                    quantity = quantityElement.value;
                }
            })


            i.addEventListener('change', () => {
                if (i.checked) {
                    selectedProducts.push({ code, name, quantity });
                    selectedProducts = [...new Set(selectedProducts)];
                } else {
                    selectedProducts = selectedProducts.filter((product) => product.code !== code);
                }

                productHTML = selectedProducts
                .map((product) => `
                    <tr>
                    <td>
                        <p>${product.code}</p>
                    </td>
                    <td>
                        <p>${product.name}</p>
                    </td>
                    <td>
                        <p>${product.quantity}</p>
                    </td>
                    <td>
                        <input type="text">
                    </td>
                    </tr>
                `)
                .join('');

            });
        }

        openDialog.addEventListener("click", () => {
            dialogRequest.showModal();
            const productList = document.getElementById('listProductReq');
            productList.innerHTML = productHTML;
        });   
    </script>
</body>
</html>